<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <title>Hub</title>
    <link rel="icon" type="image/x-icon" href="img_main/icon.png" />
    <link rel="stylesheet" href="./css_main/glowny.css" />
    <link rel="stylesheet" href="./css_main/style.css" />
    <link rel="stylesheet" href="./css_main/czcionka.css" />
    <script src="./js/translations.js"></script>
    <script src="./js/load_translation.js"></script>
    <script src="sterowanie/axios.min.js"></script>
  </head>
  <body class="jasny">
    <header id="header">
      <!-- div tylko dla lepszego ustawienia na stronie (logo i ikona obok siebie)-->
      <div id="logo_settings">
        <img
          onclick="window.location.reload()"
          src="img_main/logo.svg"
          alt="Logo"
          class="logo"
          style="cursor: pointer"
        />
        <img
          onmouseover="hover(settings_icon)"
          onmouseleave="unhover(settings_icon)"
          src="./img_main/icony/settings.png"
          alt="Settings"
          id="settings_icon"
          class="jasny"
        />
      </div>

      <script>
        function hover(element) {
          if (element.classList == "jasny") {
            element.setAttribute("src", "./img_main/icony/settings-move.gif");
          } else {
            element.setAttribute(
              "src",
              "./img_main/icony/settings-move-dark.gif"
            );
          }
        }
        function unhover(element) {
          if (element.classList == "jasny") {
            element.setAttribute("src", "./img_main/icony/settings.png");
          } else {
            element.setAttribute("src", "./img_main/icony/settings-dark.png");
          }
        }
      </script>

      <div class="hamburger" onclick="hamburger(this)">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
      </div>
      <nav class="tabs">
        <ul class="tabs-list">
          <li>
            <button
              onclick="znikanie()"
              class="tab-button active"
              data-tab="statystyki"
              data-src="wykresy/statystyki.html"
            >
              Statystyki
            </button>
          </li>
          <li>
            <button
              onclick="znikanie()"
              class="tab-button"
              data-tab="swiatla"
              data-src="wykresy/swiatla.html"
            >
              Światło
            </button>
          </li>
          <li>
            <button
              onclick="znikanie()"
              class="tab-button"
              data-tab="temperatura"
              data-src="wykresy/temperatura.html"
            >
              Temperatura
            </button>
          </li>

          <li>
            <button
              onclick="znikanie()"
              class="tab-button"
              data-tab="pietro1"
              data-src="sterowanie/sterowanie1.html"
            >
              Piętro 1
            </button>
          </li>
          <li>
            <button
              onclick="znikanie()"
              class="tab-button"
              data-tab="pietro2"
              data-src="sterowanie/sterowanie2.html"
            >
              Piętro 2
            </button>
          </li>
          <li>
            <button
              onclick="znikanie()"
              class="tab-button"
              data-tab="pietro3"
              data-src="sterowanie/sterowanie3.html"
            >
              Piętro 3
            </button>
          </li>
        </ul>
      </nav>
    </header>

    <div id="settingsModal" class="modal">
      <div class="modal-content">
        <div
          style="
            display: flex;
            align-items: center;
            flex-direction: row;
            justify-content: flex-end;
            gap: 10px;
          "
        >
          <img
            src="./img_main/icony/dark-mode.png"
            id="dark-mode"
            onclick="darkMode(), window.location.reload()"
            class="jasny"
          />
          <img
            id="poland_flag"
            onclick="zmienJezyk('pl')"
            class="flagi"
            src="./img_main/icony/poland.png"
            alt="Polish Flag"
          />
          <img
            id="germany_flag"
            onclick="zmienJezyk('de')"
            class="flagi"
            src="./img_main/icony/germany.png"
            alt="German Flag"
          />
          <img
            id="uk_flag"
            onclick="zmienJezyk('uk')"
            class="flagi"
            src="./img_main/icony/uk.png"
            alt="United Kingdom Flag"
          />
          <img
            id="silesia_flag"
            onclick="zmienJezyk('si')"
            class="flagi"
            src="./img_main/icony/silesia.png"
            alt="Silesia Flag"
          />
          <span
            style="position: inherit"
            class="close-btn"
            onclick="closeModal()"
            >&times;</span
          >
        </div>
        <h2>Ustawienia</h2>
        <p>Zmieniaj nazwy czujników i pomieszczeń.</p>
        <select id="pietro_settings_select" onchange="zmienPietroUstawienia()">
          <option value="pietro1">Piętro 1</option>
          <option value="pietro2">Piętro 2</option>
          <option value="pietro3">Piętro 3</option>
        </select>
        <div id="pietro1_urzadzenia">
          <form id="settingsForm1" class="settings_forms">
            <div id="tabelka1">
              <div class="swiatla_div" id="swiatla_div_1">
                <label for="l1_1_1">Światło 1_1:</label>
                <input type="text" id="l1_1_1" name="l1_1_1" value="1_1_1" />
                <input type="time" id="l1_1_1_time" />
                <br />
                <label for="l1_1_2">Światło 1_2:</label>
                <input type="text" id="l1_1_2" name="l1_1_2" value="1_1_2" />
                <input type="time" id="l1_1_2_time" />
                <br />
                <label for="l1_2_1">Światło 2_1:</label>
                <input type="text" id="l1_2_1" name="l1_2_1" value="1_2_1" />
                <input type="time" id="l1_2_1_time" />
                <br />
                <label for="l1_2_2">Światło 2_2:</label>
                <input type="text" id="l1_2_2" name="l1_2_2" value="1_2_2" />
                <input type="time" id="l1_2_2_time" />
                <br />
                <label for="l1_3_1">Światło 3_1:</label>
                <input type="text" id="l1_3_1" name="l1_3_1" value="1_3_1" />
                <input type="time" id="l1_3_1_time" />
                <br />
                <label for="l1_3_2">Światło 3_2:</label>
                <input type="text" id="l1_3_2" name="l1_3_2" value="1_3_2" />
                <input type="time" id="l1_3_2_time" />
                <br />
                <label for="l1_4_1">Światło 4_1:</label>
                <input type="text" id="l1_4_1" name="l1_4_1" value="1_4_1" />
                <input type="time" id="l1_4_1time" />
                <br />
                <label for="l1_4_2">Światło 4_2:</label>
                <input type="text" id="l1_4_2" name="l1_4_2" value="1_4_2" />
                <input type="time" id="l1_4_2_time" />
                <br />
                <label for="l1_5_1">Światło 5_1:</label>
                <input type="text" id="l1_5_1" name="l1_5_1" value="1_5_1" />
                <input type="time" id="l1_5_1_time" />
                <br />
                <label for="l1_5_2">Światło 5_2:</label>
                <input type="text" id="l1_5_2" name="l1_5_2" value="1_5_2" />
                <input type="time" id="l1_5_2_time" />
                <br />
                <label for="l1_6_1">Światło 6_1:</label>
                <input type="text" id="l1_6_1" name="l1_6_1" value="1_6_1" />
                <input type="time" id="l1_6_1_time" />
                <br />
                <label for="l1_6_2">Światło 6_2:</label>
                <input type="text" id="l1_6_2" name="l1_6_2" value="1_6_2" />
                <input type="time" id="l1_6_2_time" />
                <br />
                <label for="l1_7_1">Światło 7_1:</label>
                <input type="text" id="l1_7_1" name="l1_7_1" value="1_7_1" />
                <input type="time" id="l1_7_1_time" />
                <br />
                <label for="l1_7_2">Światło 7_2:</label>
                <input type="text" id="l1_7_2" name="l1_7_2" value="1_7_2" />
                <input type="time" id="l1_7_2_time" />
                <br />
              </div>
              <div class="czujniki_div" id="czujniki_div_1">
                <label for="t1_1">t1_1:</label>
                <input type="text" id="t1_1" name="t1_1" value="t1_1" />

                <br />
                <label for="t1_2">t1_2:</label>
                <input type="text" id="t1_2" name="t1_2" value="t1_2" />
                <br />
                <label for="t1_3">t1_3:</label>
                <input type="text" id="t1_3" name="t1_3" value="t1_3" />
                <br />
                <label for="t1_4">t1_4:</label>
                <input type="text" id="t1_4" name="t1_4" value="t1_4" />
                <br />
                <label for="t1_5">t1_5:</label>
                <input type="text" id="t1_5" name="t1_5" value="t1_5" />
                <br />
                <label for="t1_6">t1_6:</label>
                <input type="text" id="t1_6" name="t1_6" value="t1_6" />
                <br />
                <label for="t1_7">t1_7:</label>
                <input type="text" id="t1_7" name="t1_7" value="t1_7" />
                <br />
              </div>
              <div class="pokoje_div" id="pokoje_div_1">
                <label for="r1_1">Biuro 1:</label>
                <input type="text" id="r1_1" name="r1_1" value="Biuro 1" />
                <br />
                <label for="r1_2">Biuro 2:</label>
                <input type="text" id="r1_2" name="r1_2" value="Biuro 2" />
                <br />
                <label for="r1_3">Biuro 3:</label>
                <input type="text" id="r1_3" name="r1_3" value="Biuro 3" />
                <br />
                <label for="r1_4">Biuro 4:</label>
                <input type="text" id="r1_4" name="r1_4" value="Biuro 4" />
                <br />
                <label for="r1_5">Biuro 5:</label>
                <input type="text" id="r1_5" name="r1_5" value="Biuro 5" />
                <br />
                <label for="r1_6">Biuro 6:</label>
                <input type="text" id="r1_6" name="r1_6" value="Biuro 6" />
                <br />
                <label for="r1_7">Biuro 7:</label>
                <input type="text" id="r1_7" name="r1_7" value="Biuro 7" />
                <br />
              </div>
            </div>
            <!-- DIV do srodkowania-->
            <div id="divZapisz">
              <button
                type="button"
                class="przycisk"
                onclick="zapiszUstawienia()"
              >
                Zapisz
              </button>
            </div>
          </form>
        </div>

        <div id="pietro2_urzadzenia" style="display: none">
          <form id="settingsForm2" class="settings_forms">
            <div id="tabelka2">
              <div class="swiatla_div" id="swiatla_div_2">
                <label for="l2_1_1">Światło 1_1:</label>
                <input type="text" id="l2_1_1" name="l2_1_1" value="2_1_1" />
                <input type="time" id="l2_1_1_time" />
                <br />
                <label for="l2_1_2">Światło 1_2:</label>
                <input type="text" id="l2_1_2" name="l2_1_2" value="2_1_2" />
                <input type="time" id="l2_1_2_time" />
                <br />
                <label for="l2_2_1">Światło 2_1:</label>
                <input type="text" id="l2_2_1" name="l2_2_1" value="2_2_1" />
                <input type="time" id="l2_2_1_time" />
                <br />
                <label for="l2_2_2">Światło 2_2:</label>
                <input type="text" id="l2_2_2" name="l2_2_2" value="2_2_2" />
                <input type="time" id="l2_2_2_time" />
                <br />
                <label for="l2_3_1">Światło 3_1:</label>
                <input type="text" id="l2_3_1" name="l2_3_1" value="2_3_1" />
                <input type="time" id="l2_3_1_time" />
                <br />
                <label for="l2_3_2">Światło 3_2:</label>
                <input type="text" id="l2_3_2" name="l2_3_2" value="2_3_2" />
                <input type="time" id="l2_3_2_time" />
                <br />
                <label for="l2_4_1">Światło 4_1:</label>
                <input type="text" id="l2_4_1" name="l2_4_1" value="2_4_1" />
                <input type="time" id="l2_4_1_time" />
                <br />
                <label for="l2_4_2">Światło 4_2:</label>
                <input type="text" id="l2_4_2" name="l2_4_2" value="2_4_2" />
                <input type="time" id="l2_4_2_time" />
                <br />
                <label for="l2_5_1">Światło 5_1:</label>
                <input type="text" id="l2_5_1" name="l2_5_1" value="2_5_1" />
                <input type="time" id="l2_5_1_time" />
                <br />
                <label for="l2_5_2">Światło 5_2:</label>
                <input type="text" id="l2_5_2" name="l2_5_2" value="2_5_2" />
                <input type="time" id="l2_5_2_time" />
                <br />
                <label for="l2_6_1">Światło 6_1:</label>
                <input type="text" id="l2_6_1" name="l2_6_1" value="2_6_1" />
                <input type="time" id="l2_6_1_time" />
                <br />
                <label for="l2_6_2">Światło 6_2:</label>
                <input type="text" id="l2_6_2" name="l2_6_2" value="2_6_2" />
                <input type="time" id="l2_6_2_time" />
                <br />
                <label for="l2_7_1">Światło 7_1:</label>
                <input type="text" id="l2_7_1" name="l2_7_1" value="2_7_1" />
                <input type="time" id="l2_7_1_time" />
                <br />
                <label for="l2_7_2">Światło 7_2:</label>
                <input type="text" id="l2_7_2" name="l2_7_2" value="2_7_2" />
                <input type="time" id="l2_7_2_time" />
                <br />
              </div>
              <div class="czujniki_div" id="czujniki_div_2">
                <label for="t2_1">t2_1:</label>
                <input type="text" id="t2_1" name="t2_1" value="t2_1" />
                <br />
                <label for="t2_2">t2_2:</label>
                <input type="text" id="t2_2" name="t2_2" value="t2_2" />
                <br />
                <label for="t2_3">t2_3:</label>
                <input type="text" id="t2_3" name="t2_3" value="t2_3" />
                <br />
                <label for="t2_4">t2_4:</label>
                <input type="text" id="t2_4" name="t2_4" value="t2_4" />
                <br />
                <label for="t2_5">t2_5:</label>
                <input type="text" id="t2_5" name="t2_5" value="t2_5" />
                <br />
                <label for="t2_6">t2_6:</label>
                <input type="text" id="t2_6" name="t2_6" value="t2_6" />
                <br />
                <label for="t2_7">t2_7:</label>
                <input type="text" id="t2_7" name="t2_7" value="t2_7" />
                <br />
              </div>
              <div class="pokoje_div" id="pokoje_div_2">
                <label for="r2_1">Biuro 1:</label>
                <input type="text" id="r2_1" name="r2_1" value="Biuro 1" />
                <br />
                <label for="r2_2">Biuro 2:</label>
                <input type="text" id="r2_2" name="r2_2" value="Biuro 2" />
                <br />
                <label for="r2_3">Biuro 3:</label>
                <input type="text" id="r2_3" name="r2_3" value="Biuro 3" />
                <br />
                <label for="r2_4">Biuro 4:</label>
                <input type="text" id="r2_4" name="r2_4" value="Biuro 4" />
                <br />
                <label for="r2_5">Biuro 5:</label>
                <input type="text" id="r2_5" name="r2_5" value="Biuro 5" />
                <br />
                <label for="r2_6">Biuro 6:</label>
                <input type="text" id="r2_6" name="r2_6" value="Biuro 6" />
                <br />
                <label for="r2_7">Biuro 7:</label>
                <input type="text" id="r2_7" name="r2_7" value="Biuro 7" />
                <br />
              </div>
            </div>
            <div id="divZapisz">
              <button
                type="button"
                class="przycisk"
                onclick="zapiszUstawienia()"
              >
                Zapisz
              </button>
            </div>
          </form>
        </div>

        <div id="pietro3_urzadzenia" style="display: none">
          <form id="settingsForm3" class="settings_forms">
            <div id="tabelka3">
              <div class="swiatla_div" id="swiatla_div_3">
                <label for="l3_1_1">Światło 1_1:</label>
                <input type="text" id="l3_1_1" name="l3_1_1" value="3_1_1" />
                <input type="time" id="l3_1_1_time" />
                <br />
                <label for="l3_1_2">Światło 1_2:</label>
                <input type="text" id="l3_1_2" name="l3_1_2" value="3_1_2" />
                <input type="time" id="l3_1_2_time" />
                <br />
                <label for="l3_2_1">Światło 2_1:</label>
                <input type="text" id="l3_2_1" name="l3_2_1" value="3_2_1" />
                <input type="time" id="l3_2_1_time" />
                <br />
                <label for="l3_2_2">Światło 2_2:</label>
                <input type="text" id="l3_2_2" name="l3_2_2" value="3_2_2" />
                <input type="time" id="l3_2_2_time" />
                <br />
                <label for="l3_3_1">Światło 3_1:</label>
                <input type="text" id="l3_3_1" name="l3_3_1" value="3_3_1" />
                <input type="time" id="l3_3_1_time" />
                <br />
                <label for="l3_3_2">Światło 3_2:</label>
                <input type="text" id="l3_3_2" name="l3_3_2" value="3_3_2" />
                <input type="time" id="l3_3_2_time" />
                <br />
                <label for="l3_4_1">Światło 4_1:</label>
                <input type="text" id="l3_4_1" name="l3_4_1" value="3_4_1" />
                <input type="time" id="l3_4_1_time" />
                <br />
                <label for="l3_4_2">Światło 4_2:</label>
                <input type="text" id="l3_4_2" name="l3_4_2" value="3_4_2" />
                <input type="time" id="l3_4_2_time" />
                <br />
                <label for="l3_5_1">Światło 5_1:</label>
                <input type="text" id="l3_5_1" name="l3_5_1" value="3_5_1" />
                <input type="time" id="l3_5_1_time" />
                <br />
                <label for="l3_5_2">Światło 5_2:</label>
                <input type="text" id="l3_5_2" name="l3_5_2" value="3_5_2" />
                <input type="time" id="l3_5_2_time" />
                <br />
                <label for="l3_6_1">Światło 6_1:</label>
                <input type="text" id="l3_6_1" name="l3_6_1" value="3_6_1" />
                <input type="time" id="l3_6_1_time" />
                <br />
                <label for="l3_6_2">Światło 6_2:</label>
                <input type="text" id="l3_6_2" name="l3_6_2" value="3_6_2" />
                <input type="time" id="l3_6_2_time" />
                <br />
                <label for="l3_7_1">Światło 7_1:</label>
                <input type="text" id="l3_7_1" name="l3_7_1" value="3_7_1" />
                <input type="time" id="l3_7_1_time" />
                <br />
                <label for="l3_7_2">Światło 7_2:</label>
                <input type="text" id="l3_7_2" name="l3_7_2" value="3_7_2" />
                <input type="time" id="l3_7_2_time" />
                <br />
              </div>
              <div class="czujniki_div" id="czujniki_div_3">
                <label for="t3_1">t3_1:</label>
                <input type="text" id="t3_1" name="t3_1" value="t3_1" />
                <br />
                <label for="t3_2">t3_2:</label>
                <input type="text" id="t3_2" name="t3_2" value="t3_2" />
                <br />
                <label for="t3_3">t3_3:</label>
                <input type="text" id="t3_3" name="t3_3" value="t3_3" />
                <br />
                <label for="t3_4">t3_4:</label>
                <input type="text" id="t3_4" name="t3_4" value="t3_4" />
                <br />
                <label for="t3_5">t3_5:</label>
                <input type="text" id="t3_5" name="t3_5" value="t3_5" />
                <br />
                <label for="t3_6">t3_6:</label>
                <input type="text" id="t3_6" name="t3_6" value="t3_6" />
                <br />
                <label for="t3_7">t3_7:</label>
                <input type="text" id="t3_7" name="t3_7" value="t3_7" />
                <br />
              </div>
              <div class="pokoje_div" id="pokoje_div_3">
                <label for="r3_1">Biuro 1:</label>
                <input type="text" id="r3_1" name="r3_1" value="Biuro 1" />
                <br />
                <label for="r3_2">Biuro 2:</label>
                <input type="text" id="r3_2" name="r3_2" value="Biuro 2" />
                <br />
                <label for="r3_3">Biuro 3:</label>
                <input type="text" id="r3_3" name="r3_3" value="Biuro 3" />
                <br />
                <label for="r3_4">Biuro 4:</label>
                <input type="text" id="r3_4" name="r3_4" value="Biuro 4" />
                <br />
                <label for="r3_5">Biuro 5:</label>
                <input type="text" id="r3_5" name="r3_5" value="Biuro 5" />
                <br />
                <label for="r3_6">Biuro 6:</label>
                <input type="text" id="r3_6" name="r3_6" value="Biuro 6" />
                <br />
                <label for="r3_7">Biuro 7:</label>
                <input type="text" id="r3_7" name="r3_7" value="Biuro 7" />
                <br />
              </div>
            </div>
            <div id="divZapisz">
              <button
                type="button"
                class="przycisk"
                onclick="zapiszUstawienia()"
              >
                Zapisz
              </button>
            </div>
          </form>
        </div>
        <button
          id="reset"
          title="Naciśnij dwukrotnie aby zresetowac nazwy"
          ondblclick="resetujNazwy()"
        >
          Reset
        </button>
        <script>
          let pietro = 1;
          function zmienPietroUstawienia() {
            document.getElementById("pietro1_urzadzenia").style.display =
              "none";
            document.getElementById("pietro2_urzadzenia").style.display =
              "none";
            document.getElementById("pietro3_urzadzenia").style.display =
              "none";

            const wybranePietroElement = document.getElementById(
              "pietro_settings_select"
            ).value;

            if (wybranePietroElement === "pietro1") {
              document.getElementById("pietro1_urzadzenia").style.display =
                "block";
              pietro = 1;
            } else if (wybranePietroElement === "pietro2") {
              document.getElementById("pietro2_urzadzenia").style.display =
                "block";
              pietro = 2;
            } else if (wybranePietroElement === "pietro3") {
              document.getElementById("pietro3_urzadzenia").style.display =
                "block";
              pietro = 3;
            }
          }

          let language = "pl"; // domyślny język

          function zmienJezyk(lang) {
            language = lang;
            if (lang == "pl") {
              document.getElementById("poland_flag").style.border =
                "2px solid red";
              document.getElementById("germany_flag").style.border = "none";
              document.getElementById("uk_flag").style.border = "none";
              document.getElementById("silesia_flag").style.border = "none";
            } else if (lang == "de") {
              document.getElementById("germany_flag").style.border =
                "2px solid red";
              document.getElementById("poland_flag").style.border = "none";
              document.getElementById("uk_flag").style.border = "none";
              document.getElementById("silesia_flag").style.border = "none";
            } else if (lang == "uk") {
              document.getElementById("uk_flag").style.border = "2px solid red";
              document.getElementById("poland_flag").style.border = "none";
              document.getElementById("germany_flag").style.border = "none";
              document.getElementById("silesia_flag").style.border = "none";
            } else if (lang == "si") {
              document.getElementById("silesia_flag").style.border =
                "2px solid red";
              document.getElementById("poland_flag").style.border = "none";
              document.getElementById("germany_flag").style.border = "none";
              document.getElementById("uk_flag").style.border = "none";
            }
          }
          //funkcja po nacisnieciu przycisku zapisz
          async function zapiszUstawienia() {
            const allLights = [
              "l1_1_1",
              "l1_1_2",
              "l1_2_1",
              "l1_2_2",
              "l1_3_1",
              "l1_3_2",
              "l1_4_1",
              "l1_4_2",
              "l1_5_1",
              "l1_5_2",
              "l1_6_1",
              "l1_6_2",
              "l1_7_1",
              "l1_7_2",
              "l2_1_1",
              "l2_1_2",
              "l2_2_1",
              "l2_2_2",
              "l2_3_1",
              "l2_3_2",
              "l2_4_1",
              "l2_4_2",
              "l2_5_1",
              "l2_5_2",
              "l2_6_1",
              "l2_6_2",
              "l2_7_1",
              "l2_7_2",
              "l3_1_1",
              "l3_1_2",
              "l3_2_1",
              "l3_2_2",
              "l3_3_1",
              "l3_3_2",
              "l3_4_1",
              "l3_4_2",
              "l3_5_1",
              "l3_5_2",
              "l3_6_1",
              "l3_6_2",
              "l3_7_1",
              "l3_7_2",
            ];
            document.cookie = `lang=${language}; path=/; max-age=31536000`; // ustawienie ciasteczka z jezykiem na rok

            const pietro1 = document.getElementById("pietro1_urzadzenia");
            const pietro2 = document.getElementById("pietro2_urzadzenia");
            const pietro3 = document.getElementById("pietro3_urzadzenia");
            const form1 = document.getElementById("settingsForm1");
            const form2 = document.getElementById("settingsForm2");
            const form3 = document.getElementById("settingsForm3");

            const modal = document.getElementById("settingsModal");
            if (pietro == 1) {
              const data1 = new FormData(form1);

              setCookie("pietro1", JSON.stringify(Object.fromEntries(data1)));
            } else if (pietro == 2) {
              const data2 = new FormData(form2);

              setCookie("pietro2", JSON.stringify(Object.fromEntries(data2)));
            } else if (pietro == 3) {
              const data3 = new FormData(form3);

              setCookie("pietro3", JSON.stringify(Object.fromEntries(data3)));
            }

            let harmonogram = {};
            for (let i = 0; i < allLights.length; i++) {
              const light = allLights[i];
              const el = document.getElementById(`${light}_time`);
              if (el) {
                const time = el.value;
                if (time) {
                  harmonogram[light] = time;
                }
              }
            }

            console.log("Harmonogram:", harmonogram);
            if (Object.keys(harmonogram).length > 0) {
              await ustawHarmonogram(harmonogram);
            } else {
              console.log("Brak harmonogramu do ustawienia.");
            }
            modal.style.display = "none"; // zamknij modal po zapisaniu
            window.location.reload(); // odśwież stronę, aby zastosować zmiany
          }
          async function ustawHarmonogram(harmonogram = null) {
            if (harmonogram === null) {
              const godzinaInput = document.getElementById(
                `harmonogramGodzinaInput`
              );
              const godzina = godzinaInput.value;
              harmonogram = {
                all_OFF_l3: `${godzina}`,
                all_OFF_l2: `${godzina}`,
              };
              await axios.put(
                `http://192.168.25.59:3000/harmonogram/add`,
                harmonogram
              );
            } else {
              await axios.put(
                `http://192.168.25.59:3000/harmonogram/add`,

                harmonogram
              );
            }
          }
          function setCookie(name, value) {
            const d = new Date();
            d.setFullYear(d.getFullYear() + 1000); // dodaj 1000 lat

            const expires = "expires=" + d.toUTCString();
            console.log("Ciasteczko wygasnie:", expires);
            document.cookie =
              name +
              "=" +
              encodeURIComponent(value) +
              ";" +
              expires +
              ";path=/";
          }

          //deafulowe wartosci zeby utworzyc ciasteczka
          const default1 = {
            l1_1_1: "1_1_1",
            l1_1_2: "1_1_2",
            l1_2_1: "1_2_1",
            l1_2_2: "1_2_2",
            l1_3_1: "1_3_1",
            l1_3_2: "1_3_2",
            l1_4_1: "1_4_1",
            l1_4_2: "1_4_2",
            l1_5_1: "1_5_1",
            l1_5_2: "1_5_2",
            l1_6_1: "1_6_1",
            l1_6_2: "1_6_2",
            l1_7_1: "1_7_1",
            l1_7_2: "1_7_2",
            t1_1: "t1_1",
            t1_2: "t1_2",
            t1_3: "t1_3",
            t1_4: "t1_4",
            t1_5: "t1_5",
            t1_6: "t1_6",
            t1_7: "t1_7",
            r1_1: "r1_1",
            r1_2: "r1_2",
            r1_3: "r1_3",
            r1_4: "r1_4",
            r1_5: "r1_5",
            r1_6: "r1_6",
            r1_7: "r1_7",
          };
          const default2 = {
            l2_1_1: "2_1_1",
            l2_1_2: "2_1_2",
            l2_2_1: "2_2_1",
            l2_2_2: "2_2_2",
            l2_3_1: "2_3_1",
            l2_3_2: "2_3_2",
            l2_4_1: "2_4_1",
            l2_4_2: "2_4_2",
            l2_5_1: "2_5_1",
            l2_5_2: "2_5_2",
            l2_6_1: "2_6_1",
            l2_6_2: "2_6_2",
            l2_7_1: "2_7_1",
            l2_7_2: "2_7_2",
            t2_1: "t2_1",
            t2_2: "t2_2",
            t2_3: "t2_3",
            t2_4: "t2_4",
            t2_5: "t2_5",
            t2_6: "t2_6",
            t2_7: "t2_7",
            r2_1: "r2_1",
            r2_2: "r2_2",
            r2_3: "r2_3",
            r2_4: "r2_4",
            r2_5: "r2_5",
            r2_6: "r2_6",
            r2_7: "r2_7",
          };
          const default3 = {
            l3_1_1: "3_1_1",
            l3_1_2: "3_1_2",
            l3_2_1: "3_2_1",
            l3_2_2: "3_2_2",
            l3_3_1: "3_3_1",
            l3_3_2: "3_3_2",
            l3_4_1: "3_4_1",
            l3_4_2: "3_4_2",
            l3_5_1: "3_5_1",
            l3_5_2: "3_5_2",
            l3_6_1: "3_6_1",
            l3_6_2: "3_6_2",
            l3_7_1: "3_7_1",
            l3_7_2: "3_7_2",
            t3_1: "t3_1",
            t3_2: "t3_2",
            t3_3: "t3_3",
            t3_4: "t3_4",
            t3_5: "t3_5",
            t3_6: "t3_6",
            t3_7: "t3_7",
            r3_1: "r3_1",
            r3_2: "r3_2",
            r3_3: "r3_3",
            r3_4: "r3_4",
            r3_5: "r3_5",
            r3_6: "r3_6",
            r3_7: "r3_7",
          };

          function getCookie(name) {
            let cname = name + "=";
            let decodedCookie = decodeURIComponent(document.cookie);
            let ca = decodedCookie.split(";");
            for (let i = 0; i < ca.length; i++) {
              let c = ca[i].trim();
              if (c.indexOf(cname) == 0) {
                return c.substring(cname.length, c.length);
              }
            }
            return "";
          }

          function resetujNazwy() {
            // Resetowanie ciasteczek do domyślnych wartości
            setCookie("pietro1", JSON.stringify(default1));
            setCookie("pietro2", JSON.stringify(default2));
            setCookie("pietro3", JSON.stringify(default3));
            // Odświeżenie strony po zresetowaniu
            window.location.reload();
          }

          // Sprawdzenie ciasteczek i ustawienie domyślnych wartości
          if (getCookie("pietro1") === "") {
            setCookie("pietro1", JSON.stringify(default1));
          }
          if (getCookie("pietro2") === "") {
            setCookie("pietro2", JSON.stringify(default2));
          }
          if (getCookie("pietro3") === "") {
            setCookie("pietro3", JSON.stringify(default3));
          }
          // Odczyt ciasteczek i ustawienie wartości w formularzach
          document.addEventListener("DOMContentLoaded", () => {
            ["pietro1", "pietro2", "pietro3"].forEach((p) => {
              const cookieData = getCookie(p);
              if (cookieData) {
                try {
                  const parsed = JSON.parse(cookieData);
                  Object.entries(parsed).forEach(([key, value]) => {
                    const input = document.getElementById(key);
                    if (input) {
                      input.value = value;
                    }
                  });
                } catch (e) {
                  console.warn("Błąd odczytu ciasteczka dla", p, e);
                }
              }
            });
            wczytajHarmonogram();
          });
          async function wczytajHarmonogram() {
            const harmonogram = await axios.get(
              "http://192.168.25.59:3000/harmonogram"
            );
            Object.entries(harmonogram["data"]).forEach(([key, value]) => {
              const el = document.getElementById(`${key}_time`);
              if (el) {
                el.value = value;
              } else {
              }
            });
          }
        </script>
      </div>
    </div>

    <main>
      <section id="statystyki" class="tab-content active">
        <iframe
          src="wykresy/statystyki.html"
          frameborder="0"
          width="100%"
          height="100%"
          id="ramka"
        ></iframe>
      </section>
      <section id="swiatla" class="tab-content"></section>
      <section id="temperatura" class="tab-content"></section>
      <section id="pietro1" class="tab-content">
        <h1>strona 2</h1>
        <p>zakladka</p>
      </section>
      <section id="pietro2" class="tab-content">
        <h1>strona 3</h1>
        <p>zakladka</p>
      </section>
      <section id="pietro3" class="tab-content">
        <h1>strona 3</h1>
        <p>zakladka</p>
      </section>
    </main>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const modal = document.getElementById("settingsModal");
        modal.style.display = "none"; // Hide modal initially
        const settingsIcon = document.getElementById("settings_icon");
        settingsIcon.addEventListener("click", () => {
          modal.style.display = "flex";
        });
        function closeModal() {
          modal.style.display = "none";
        }
        window.closeModal = closeModal;
      });
    </script>
    <script>
      const modal = document.getElementById("settingsModal");
      const settingsIcon = document.getElementById("settings_icon");
      settingsIcon.addEventListener("click", () => {
        modal.style.display = "flex";
      });
      function closeModal() {
        modal.style.display = "none";
      }
    </script>
    <script src="./js/tabs.js"></script>
    <script src="js/dark_mode.js"></script>
  </body>
</html>
